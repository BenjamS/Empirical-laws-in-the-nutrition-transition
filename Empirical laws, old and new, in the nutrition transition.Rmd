---
title: Empirical laws, old and new, in the nutrition transition
author:
  - name: Benjamin Schiek
    email: b.schiek@cgiar.org
    affiliation: Alliance Bioversity-CIAT
    footnote: Corresponding Author
address:
  - code: Alliance Bioversity-CIAT
    address: Alliance Bioversity-CIAT, Km 17 Recta Cali-Palmira, Valle del Cauca, Colombia
abstract: |
  Engel's Law and Bennett's Law are often mentioned in the nutrition transition literature. But seldom is any evidence of their validity presented in a straightforward, visual manner. Here I present...using FAO and World Bank data. I also present variant formulations which fit the data more cleanly. Including consumption inequality in the model improves the fit. The fitted slope and y-intercept parameters are fairly stable across four and a half decades of data. Animations (available as supplemental material) offer striking visual confirmation of this stability. I propose a new theoretical framework that unifies the two laws as separate manifestations of a single underlying principle. Finally, I present another empirical law that appears to have gone unnoticed until now: a tight log-linear corresponance between commodity expected price and price volatility.
keywords: Nutrition transition, Bennett's Law, Engel's Law, Global food demand, Food price volatility
journal: "CG Space"
bibliography: Empirical laws, old and new, in the nutrition transition.bib
header-includes:
  - \usepackage{float}
  - \floatplacement{figure}{H}
#linenumbers: true
numbersections: true
csl: elsevier-harvard.csl
output:
    rticles::elsevier_article:
    latex_engine: xelatex
mainfont: Garamond
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE)
library(plyr)
library(tidyverse)
library(patchwork)
library(ggrepel)
#library(kableExtra)
shape_vec <- c(21:24, 4)
point_size <- 2
label_size <- 4

#==========================================================================
shift_legend2 <- function(p) {
  # ...
  # to grob
  gp <- ggplotGrob(p)
  facet.panels <- grep("^panel", gp[["layout"]][["name"]])
  empty.facet.panels <- sapply(facet.panels, function(i) "zeroGrob" %in% class(gp[["grobs"]][[i]]))
  empty.facet.panels <- facet.panels[empty.facet.panels]
  
  # establish name of empty panels
  empty.facet.panels <- gp[["layout"]][empty.facet.panels, ]
  names <- empty.facet.panels$name
  # example of names:
  #[1] "panel-3-2" "panel-3-3"
  
  # now we just need a simple call to reposition the legend
  #lemon::reposition_legend(p, 'center', panel=names)
  p_out <- lemon::reposition_legend(p, 'center', panel=names)
  #class(lemon::reposition_legend(p, 'center', panel=names))
  return(p_out)
}
#==========================================================================

```

# Introduction

A good understanding of Bennett's Law [@bennett1941international] and Engel's Law [-@zimmerman1932ernst] is key to understanding the future composition and quantity of food demand, at all scales. The laws figured centrally in the food crisis literature of the 1960s [@brown1963man]; and, nowadays, form the _implicit_ premise of much of the Nutrition Transition literature [@popkin1993nutritional;]. However, this time around there is surprisingly little explicit reference to or graphical representation of the laws. It appears, moreover, that many donors and aid organizations, and even some researchers, are simply unaware of their existence. Tilman et al. [-@tilman2011global], for example, present what they believe to be a newly discovered empirical relation between Gross Domestic Product (GDP) and calorie consumption; whereas this is more accurately characterized as a corrollary of the empirical relation observed by Engel in 1841. International breeding programs, meanwhile, continue to emphasize cereals over non-starchy crops well in excess of what would be justified by Bennett's Law [EIB report].

Here, I open a parenthesis in the Nutrition Transition discussion to 
For these reasons, it is worhtwhile to open a parenthesis in the Nutrition Transition discussion in order to take stock of and appreciate the relevance of these empirical laws in policy making contexts. Here, I make a contribution in this direction by presenting a graphical analysis of Bennett's and Engel's Laws in greater detail than has so far appeared in the literature. I also explore variant formulations of the laws that improve the fit with the data. Animations of the analysis^[Presented in the supplemental materials.] provide striking confirmation of the stability of these laws over time. I then discuss briefly how Bennett's and Engel's Laws can be thought of as two manifestations of the law of diminishing marginal utility.

Finally, I present a new empirical law that appears to govern the relation between a commodity's expected price and its price risk. This new law may serve to open up new perspectives on the role of price risk in food system resilience and nutritional security---a topic which has so far received little attention within this discussion.
<!-- I then propose a theoretical unification of the two laws by deriving them both from the same principle of diminishing returns to marginal increases in expenditures on inferior goods. -->

# Bennett's Law

>"The broad fact that variety rather than uniformity is characteristic of food consumption throughout the world is familiar and indisputable. Differences are found in the 'dishes' consumed from country to country, region to region, locality to locality, even family to family. Within a country or region, these differences appear also from one epoch to another. They are so prevalent and conspicuous, in fact, that it seems almost hopeless to discover, in the international sphere, some way of characterizing summarily the diets of different nations and contrasting them one with the other" [@bennett1941international].

Even within a fairly small geographical region of Africa, diets vary considerably (Figure \ref(fig:dietDiversity)). If we were to look at each of these food catgories in more detail, we would see even more diversity in terms of what specific crops constitute the groups.

```{r dietDiversity, fig.show = "hold", fig.width = 7, fig.height=4, fig.align="center", fig.cap="Diets are diverse.", echo = FALSE}
this_file <- "Bennetts Law post_diverse diets.csv"
df_plot <- read.csv(this_file, stringsAsFactors = F)
df_plot$X.1 <- NULL
df_plot$X <- NULL
df_plot <- df_plot[, c("Area", "Year", "Item", "kcal.share", "mu_food_area_item")]
colnames(df_plot)[4] <- "Share of daily diet"
df_plot$Item[grep("Sugar", df_plot$Item)] <- "Sugar\n& sweeteners"
df_plot$Item[grep("Animal", df_plot$Item)] <- "Animal\nproducts"
df_plot$Item[grep("Roots", df_plot$Item)] <- "Starchy\nroots"
#-----------------------------------------------------------------------------
area_vec <- c("Kenya", "Uganda", "Ethiopia", "Tanzania", "Rwanda")
df_plot <- subset(df_plot, Area %in% area_vec &
                    Year > 1992)
df_plot$Year <- as.integer(df_plot$Year)
yr_min <- min(df_plot$Year)
yr_max <- max(df_plot$Year)
n <- length(unique(df_plot$Item))
bag_of_colors <- randomcoloR::distinctColorPalette(k = 2 * n)
color_vec <- sample(bag_of_colors, n)
#good_colors <- c("#B346E2", "#74B4D0", "#E16953", "#D6E1D8", "#C7E84D", "#6BE47C", "#E4B64D")
#color_vec <- good_colors
df_plot <- df_plot %>% group_by(Area, Item) %>%
  mutate(mu_food_area_item = mean(`Share of daily diet`, na.rm = T)) %>%
  as.data.frame()
df_plot$Item <- factor(df_plot$Item,
                       levels = unique(df_plot$Item[order(df_plot$mu_food_area_item, df_plot$Item, decreasing = T)]),
                       ordered = T)
gg <- ggplot(df_plot, aes(x = Year, y = `Share of daily diet`, fill = Item))
gg <- gg + geom_area(position = "stack")
gg <- gg + scale_x_continuous(breaks = seq(yr_min, yr_max, length.out = 4))
gg <- gg + scale_fill_manual(values = color_vec)
gg <- gg + facet_wrap(~Area, ncol = 3)
gg <- gg + labs(caption = "Source: FAO")
gg <- gg + theme(legend.title = element_blank(),
                 axis.title.x = element_blank())
gg <- gg + guides(fill = guide_legend(nrow = 4, byrow = T))
gg <- shift_legend2(gg)
gg <- ggplotify::as.ggplot(gg)


```
Nonetheless, Bennett found the "way of characterizing summarily the diets of different nations" he was looking for by examining the carbohydrate content of diets in relation to income. An example is given in the left panel of Figure \ref{fig:Bennet01}. The relation says that, regardless of geography and culture, carbohydrates form a declining portion of the diet as income rises.

A question remains as to how much of the carbohydrates are replaced by proteins and how much are replaced by fats, as income rises. Cursory exploration of the data reveals that the carbohydrates are replaced exclusively by fats, as income increases (right panel, Figure \ref{fig:Bennet01}). Drewnowski and Popkin [-@drewnowski1997nutrition] dispute this, claiming that globalization has led to increased fat intake regardless of income level. While there may be some truth to their argument in an absolute sense, Figure \ref{fig:Bennet01} indicates quite clearly that relative fat intake is still highly coupled with income level, despite "globalized diets".

```{r Bennett01, fig.show = "hold", fig.width = 6, fig.height=5, fig.align="center", fig.cap="\\italic{(Left)} Bennett's Law, \\italic{(Right)} the fat-carb frontier. The size of the points in the fat carb frontier correspond to the log of GDP. Source: Author's creation using the FAO Food Balance Sheets for 2017. Grams are converted to calories assuming a ratio of 4 calories per gram of protein or carbohydrate, and 9 calories per gram of fat, in accordance with U.S. Dept. of Agriculture guidelines.", echo = FALSE}
# 4 calories in a gram of protein or carbohydrate, 9 calories in a gram of fat.
# https://www.nal.usda.gov/fnic/how-many-calories-are-one-gram-fat-carbohydrate-or-protein
#===========================================================================
this_file <- "Bennetts Law data.csv"
df_bennett <- read.csv(this_file, stringsAsFactors = F)
#colnames(df_bennett)
df_bennett$X <- NULL
#colnames(df_bennett) <- gsub(".", "\\", colnames(df_bennett), fixed = T)
colnames(df_bennett)[3:9] <- c("Food supply (kcal/capita/day)",
                               "Fat supply quantity (kcal/capita/day)",
                               "Protein supply quantity (kcal/capita/day)",
                               "Carb supply quantity (kcal/capita/day)",
                               "Fat share of diet (%)",
                               "Carb share of diet (%)",
                               "Carb share of diet (%), logged")
colnames(df_bennett)[11] <- "GDP / capita (USD), logged"
#===========================================================================
# Bennett's Law
df_plot <- subset(df_bennett, Year == "2017")
df_mod <- df_plot[, c("Carb share of diet (%), logged", "GDP / capita (USD), logged")]
mod <- lm(`Carb share of diet (%), logged` ~., data = df_mod)
#summary(mod)
m <- round(mod$coefficients[2], 2)
b <- round(mod$coefficients[1], 2)
df_out <- as.data.frame(broom::glance(mod))
adjR2 <- round(df_out$adj.r.squared, 2)
#-----------------------------------------------------------------------------
label_Africa <- c("Tanzania", "Uganda", "Ethiopia", "South Africa",
                  "Ghana")
label_NAfricaWAsia <- c("Turkey", "Saudi Arabia")
label_Asia <- c("India", "Iran", "China, mainland", "Vietnam", "Japan",
                "South Korea")
label_NAmEurAusNZ <- c("Italy", "France", "Australia")
label_LAC <- c("Nicaragua", "Colombia", "Brazil")
labelThese_vec <- c(label_Africa, label_NAfricaWAsia, label_Asia,
                    label_NAmEurAusNZ, label_LAC)
#-----------------------------------------------------------------------------

df_plot$label_these <- NA
u <- df_plot$Country
df_plot$label_these[which(u %in% labelThese_vec)] <- df_plot$Country[which(u %in% labelThese_vec)]

n <- length(unique(df_plot$Region))
bag_of_colors <- randomcoloR::distinctColorPalette(k = 2 * n)
color_vec <- sample(bag_of_colors, n)
this_subtitle <- paste0("Adj. R squared = ", adjR2, ", Slope = ", m, ", y-intercept = ", b)
gg <- ggplot(df_plot, aes(x = `GDP / capita (USD), logged`,
                          y = `Carb share of diet (%), logged`,             
                          group = Region, fill = Region,
                          shape = Region,
                          label = label_these))
# gg <- gg + geom_point(aes(fill = Region, group = Region, shape = Region), pch = 21, alpha = 0.5, size = 6, color = "black")
gg <- gg + geom_smooth(aes(group = NULL, fill = NULL, shape = NULL), method = lm, se = F)
gg <- gg + geom_point(alpha = 0.6, size = point_size, color = "black", stroke = 1)
gg <- gg + scale_fill_manual(values = color_vec)
gg <- gg + scale_shape_manual(values = shape_vec)
# gg <- gg + geom_abline(slope = m, intercept = b,
#                        linetype = "dashed", size = 1)
gg <- gg + geom_text_repel(color = "black", size = label_size)
gg <- gg + labs(title = "Bennett's Law", 
  subtitle = this_subtitle)#,
#caption = "Source: Author's creation based on World Bank International Comparison Program Data for 2017.
#GDP/capita is based on 2015 prices.")
gg <- gg + guides(fill = guide_legend(nrow = 2, byrow = T, override.aes = list(linetype = 0)),
                  color = guide_legend(override.aes = list(linetype = 0)))
gg <- gg + theme(legend.position = "bottom",
                  legend.spacing.x = unit(0.25, 'cm'),
                  legend.title = element_blank())
gg_BennettsLaw <- gg
#=========================================================================
# Fat-Carb Frontier
df_mod <- df_plot[, c("Carb share of diet (%)", "Fat share of diet (%)")]
mod <- lm(`Carb share of diet (%)` ~., data = df_mod)
#summary(mod)
m <- round(mod$coefficients[2], 2)
b <- round(mod$coefficients[1], 2)
df_out <- as.data.frame(broom::glance(mod))
adjR2 <- round(df_out$adj.r.squared, 2)

# df_plot$Country[which(df_plot$`Fat share of diet (%)` ==
#                         max(df_plot$`Fat share of diet (%)`))]
df_plot <- subset(df_plot, Country != "Slovakia")
#colnames(df_plot)
df_plot$`GDP / capita (USD)` <- exp(df_plot$`GDP / capita (USD), logged`)
this_subtitle <- paste0("Adj. R squared = ", adjR2, ", Slope = ", m, ", y-intercept = ", b)
gg <- ggplot(df_plot, aes(x = `Fat share of diet (%)`,
                          y = `Carb share of diet (%)`,
                          group = Region, fill = Region,
                          shape = Region, size = `GDP / capita (USD)`,
                          label = label_these))
gg <- gg + geom_smooth(aes(group = NULL, fill = NULL, shape = NULL), method = lm, se = F)
gg <- gg + geom_point(alpha = 0.6, color = "black", stroke = 1)
gg <- gg + scale_fill_manual(values = color_vec)
gg <- gg + scale_shape_manual(values = shape_vec)
# gg <- gg + geom_abline(slope = m, intercept = b,
#                        linetype = "dashed", size = 1)
gg <- gg + geom_text_repel(color = "black", size = label_size)
gg <- gg + labs(title = "The fat-carb frontier", 
  subtitle = this_subtitle)#,
#caption = "Source: Author's creation based on World Bank International Comparison Program Data for 2017.
#GDP/capita is based on 2015 prices.")
gg <- gg + theme(legend.position = "none",
                legend.spacing.x = unit(0.25, 'cm'),
                legend.title = element_blank())
gg <- gg + guides(fill = guide_legend(nrow = 2, byrow = T, override.aes = list(linetype = 0)),
                  color = guide_legend(override.aes = list(linetype = 0)),
                  size = F)
gg_fatCarbFrontier <- gg
# gg1 + gg2 + plot_layout(ncol = 2, guides = "collect") & theme(legend.position = 'bottom')
#===========================================================================
# wrap_plots(list(gg_BennettsLaw, gg_fatCarbFrontier), ncol = 2, guides = "collect")
# gg_BennettsLaw + gg_fatCarbFrontier + plot_layout(guides = "collect") & theme(legend.position = "bottom")
(gg_BennettsLaw + plot_layout(guides = "collect") & theme(legend.position = "bottom")) + (gg_fatCarbFrontier + theme(legend.position = "none"))

```

The slopes and y-intercepts of both Bennett's Law and the fat-carb frontier are remarkably stable over time (Figure \ref{fig:BennettStability}). Animations of these plots, provided in the supplemental materials, offer additional visual confirmation of this stability.

Perisse et al. [-@perisse1969effect] found that the protein share of diets remains roughly constant at 11% across all income levels. The slope on the fat-carb frontier is nearly -1, which supports this finding (although the y-intercept (~91%) implies a constant protein share of 9%, slightly lower than Perisse et al.'s estimate). Metabolically speaking, constant protein intake in the face of declining carbohydrate intake implies increased consumption of animal products. (The increased fat intake also implies this to some degree, although not necessarily, since fats may be acquired from non-animal sources.) The often mentioned dietary transition to animal products that accompanies rising incomes and urbanization may thus be considered a corrollary of Bennett's Law.

Clearly, Bennett's Law can be useful for determining the future composition of food demand as a function of GDP growth. Only recently have researchers begun to take advantage of this potential. Gouel and Guimbard [-@gouel2019nutrition] introduce a novel demand model that integrates Bennett's Law, and find that demand for starchy crops will grow by just 30.8% in 2050, whereas demand for non-starchy commodities will grow by 35.5% (in the case of pulses, nuts, and oilcrops) to 72.1% (in the case of oils and fats). International agricultural research investment decisions, on the other hand, appear to be made without much regard for Bennett's Law. The largest share of investment continues to go into starchy crop research, with smaller portions invested in the non-starchy commodity groups for which demand is growing most quickly [@ispc2018; @finplan2018].

```{r BennettStability, fig.show = "hold", fig.width = 5, fig.height=3, fig.align="center", fig.cap="Parameter stability over time (1970-2017) for \\italic{(Left)} Bennett's Law and \\italic{(Right)} the fat-carb frontier.", echo = FALSE}

df_params <- df_bennett[, c("Year", "Carb share of diet (%), logged",
                            "GDP / capita (USD), logged")]
df_params <- df_params[which(!is.na(df_params$`Carb share of diet (%), logged`)), ]

yr_vec <- unique(df_params$Year)
n_yrs <- length(yr_vec)
m_vec <- c()
b_vec <- c()
adjR2_vec <- c()
for(i in 1:n_yrs){
  this_year <- yr_vec[i]
  this_df <- subset(df_params, Year == this_year)
  this_df$Year <- NULL
  mod <- lm(`Carb share of diet (%), logged`~., this_df)
  m_vec[i] <- round(mod$coefficients[2], 3)
  b_vec[i] <- round(mod$coefficients[1], 3)
  df_out <- as.data.frame(broom::glance(mod))
  adjR2_vec[i] <- df_out$adj.r.squared
  
}

df_plot <- data.frame(Year = yr_vec, Slope = m_vec, b_vec, adjR2_vec)
colnames(df_plot)[3:4] <- c("Y-intercept", "Adj. R squared")
# mean(df_plot$Slope)
# sd(df_plot$Slope)
# mean(df_plot$`Y-intercept`)
# sd(df_plot$`Y-intercept`)

df_plot$Year <- as.integer(as.character(df_plot$Year))
df_plot <- df_plot %>% gather(Type, Value, Slope:`Adj. R squared`)
gg <- ggplot(df_plot, aes(x = Year, y = Value))
gg <- gg + geom_line()
# gg <- gg + scale_x_continuous(breaks = seq(yr_vec[1], yr_vec[n_yrs - 1], length.out = 24))
gg <- gg + facet_wrap(~Type, ncol = 1, scales = "free_y")
gg <- gg + labs(subtitle = "Bennet's Law stability")
gg <- gg + theme(axis.title = element_blank(),
                  axis.text.x = element_text(angle = 60, hjust = 1),
                  strip.background = element_blank())
gg_BennettStab <- gg
#===========================================================================

df_params <- df_bennett[, c("Year", "Carb share of diet (%)",
                            "Fat share of diet (%)")]
# df_params <- df_params[which(!is.na(df_params$`Carb share of diet (%), logged`)), ]

yr_vec <- unique(df_params$Year)
n_yrs <- length(yr_vec)
m_vec <- c()
b_vec <- c()
adjR2_vec <- c()
for(i in 1:n_yrs){
  this_year <- yr_vec[i]
  this_df <- subset(df_params, Year == this_year)
  this_df$Year <- NULL
  mod <- lm(`Carb share of diet (%)`~., this_df)
  m_vec[i] <- round(mod$coefficients[2], 3)
  b_vec[i] <- round(mod$coefficients[1], 3)
  df_out <- as.data.frame(broom::glance(mod))
  adjR2_vec[i] <- df_out$adj.r.squared
  
}

df_plot <- data.frame(Year = yr_vec, Slope = m_vec, b_vec, adjR2_vec)
colnames(df_plot)[3:4] <- c("Y-intercept", "Adj. R squared")
# mean(df_plot$Slope)
# sd(df_plot$Slope)
# mean(df_plot$`Y-intercept`)
# sd(df_plot$`Y-intercept`)

df_plot$Year <- as.integer(as.character(df_plot$Year))
df_plot <- df_plot %>% gather(Type, Value, Slope:`Adj. R squared`)
gg <- ggplot(df_plot, aes(x = Year, y = Value))
gg <- gg + geom_line()
# gg <- gg + scale_x_continuous(breaks = seq(yr_vec[1], yr_vec[n_yrs - 1], length.out = 24))
gg <- gg + facet_wrap(~Type, ncol = 1, scales = "free_y")
gg <- gg + labs(subtitle = "Fat-carb frontier stability")
gg <- gg + theme(axis.title = element_blank(),
                  axis.text.x = element_text(angle = 60, hjust = 1),
                  strip.background = element_blank())
gg_fatCarbStab <- gg
#===========================================================================

gg_BennettStab + gg_fatCarbStab + plot_layout(ncol = 2)

```

note that the slope and y-intercept appear to be inversely related...graph...effectively reducing Bennett's Law to a one parameter model.

... Geographically disaggregated...a little less stable.

...estimate future carb demand based on Bennett's Law, compare to actual breeding emphasis on cereals.

# Engel's Law

Nearly a century prior to Bennett's discovery, the young Director of the Statistical Bureau of Saxony, Ernst Engel, was poring over 199 Belgian working class budgets, when he noticed that

>"[t]he poorer the individual, a family, or a people, the greater must be the percentage of the income necessary for the maintenance of physical sustenance, and again of this a greater portion must be allowed for food" [@zimmerman1932ernst].

Engel went on to conclude that "[t]he proportion of the outgo used for food, other things being equal, is the best measure of the material standard of living of a population" [-@zimmerman1932ernst]. Numerous authors cast doubt on the validity of Engel's observation across different cultural and socioeconomic contexts. Nonetheless, Engel's Law has emerged, today, as a universal empirical phenomenon, regardless of context. An example is given in the left panel of Figure \ref{fig:Engel0}.

```{r Engel0, fig.show = "hold", fig.width = 5, fig.height=4, fig.align="center", fig.cap="Engel's Law. Source: Author's creation based on World Bank International Comparison Program data for 2017. GDP/capita is retrieved from the FAO database and is based on 2015 prices.", echo = FALSE}
#===========================================================================
this_file <- "Engels Law 1.csv"
df_plot <- read.csv(this_file, stringsAsFactors = F)
df_plot$X <- NULL
colnames(df_plot)[3:4] <- c("GDP / capita (USD), logged",
                            "Food expenditure share of GDP (%), logged")
#---------------------------------------------------------------------------
mod <- lm(`Food expenditure share of GDP (%), logged` ~ `GDP / capita (USD), logged`, df_plot)
#summary(mod)
m <- round(mod$coefficients[2], 2)
b <- round(mod$coefficients[1], 2)
df_out <- as.data.frame(broom::glance(mod))
adjR2 <- round(df_out$adj.r.squared, 2)
# unique(df_plot$Country[which(df_plot$Region == "Asia\n(excluding W. Asia)")])
# unique(df_plot$Country[which(df_plot$Region == "N. Africa / W. Asia")])
# label_Africa <- c("Tanzania", "Uganda", "Kenya", "Ethiopia", "South Africa",
#                   "DRC", "Angola", "Ghana","Rwanda", "Mozambique")
# label_NAfricaWAsia <- c("Egypt", "Turkey", "Sudan", "Saudi Arabia", "Jordan",
#                         "Israel", "United Arab Emirates", "Kuwait")
# label_Asia <- c("India", "Iran", "China, mainland", "Vietnam", "Japan",
#                 "South Korea", "Afghanistan", "Indonesia", "Kazakhstan",
#                 "Singapore", "Tajikistan")
# label_NAmEurAusNZ <- c("Austria", "United Kingdom", "France", "Australia",
#                        "United States", "Spain", "Italy")
# label_LAC <- c("Nicaragua", "Haiti", "Argentina", "Colombia", "Mexico",
#                "Dominican Republic", "Brazil", "Uruguay")
# labelThese_vec <- c(label_Africa, label_NAfricaWAsia, label_Asia,
#                     label_NAmEurAusNZ, label_LAC)
label_Africa <- c("Tanzania", "Uganda", "Ethiopia", "South Africa",
                  "Ghana")
label_NAfricaWAsia <- c("Turkey", "Saudi Arabia")
label_Asia <- c("India", "Iran", "China, mainland", "Vietnam", "Japan",
                "South Korea")
label_NAmEurAusNZ <- c("Italy", "France", "Australia")
label_LAC <- c("Nicaragua", "Colombia", "Brazil")
labelThese_vec <- c(label_Africa, label_NAfricaWAsia, label_Asia,
                    label_NAmEurAusNZ, label_LAC)

df_plot$label_these <- NA
u <- df_plot$Country
df_plot$label_these[which(u %in% labelThese_vec)] <- u[which(u %in% labelThese_vec)]

n <- length(unique(df_plot$Region))
bag_of_colors <- randomcoloR::distinctColorPalette(k = 2 * n)
color_vec <- sample(bag_of_colors, n)

shape_vec <- c(21:24, 4)
point_size <- 2
label_size <- 4

this_subtitle <- paste0("Adj. R squared = ", adjR2, ", Slope = ", m, ", y-intercept = ", b)
gg <- ggplot(df_plot, aes(x = `GDP / capita (USD), logged`,
                          y = `Food expenditure share of GDP (%), logged`,
                          group = Region, fill = Region, shape = Region,
                          label = label_these))
# gg <- gg + geom_point(aes(fill = Region, group = Region, shape = Region), pch = 21, alpha = 0.5, size = 6, color = "black")
gg <- gg + geom_point(alpha = 0.6, size = point_size, color = "black", stroke = 1)
gg <- gg + scale_fill_manual(values = color_vec)
gg <- gg + scale_shape_manual(values = shape_vec)
# gg <- gg + geom_abline(slope = m, intercept = b,
#                        linetype = "dashed", size = 1)
gg <- gg + geom_smooth(aes(group = NULL, fill = NULL, shape = NULL), method = lm, se = F)
gg <- gg + geom_text_repel(color = "black", size = label_size)
gg <- gg + labs(title = "Engel's Law", 
  subtitle = this_subtitle)#,
#caption = "Source: Author's creation based on World Bank International Comparison Program Data for 2017.
#GDP/capita is based on 2015 prices.")
gg <- gg + guides(fill = guide_legend(nrow = 2, byrow = T, override.aes = list(linetype = 0)),
                  color = guide_legend(override.aes = list(linetype = 0)))
gg <- gg + theme(legend.position = "bottom",
                 legend.spacing.x = unit(0.5, 'cm'),
                 legend.title = element_blank())
gg
#ggsave("Engels Law 1.png", width = 8.5, height = 6.5, units = "in")

```

Engel's Law is disaggregated by geographical region in Figure \ref{fig:Engel0Disagg}. With the exception of Sub-Saharan Africa, the graphics exhibit a good fit.^[The fit for Sub-Saharan Africa can be improved by applying the alternative formulations of Engel's law discussed below.] Note that parameter values vary from one region to the next. A possible reason behind this variation is explored in the next section.

```{r Engel0Disagg, fig.show = "hold", fig.width = 6, fig.height=4, fig.align="center", fig.cap="Engel's Law by region, ICP data for 2017.", echo = FALSE}
region_vec <- unique(df_plot$Region)
facet_labels <- c()
adjR2_vec <- c()
for(i in 1:length(region_vec)){
  this_region <- region_vec[i]
  this_df_plot <- subset(df_plot, Region == this_region)
  mod <- lm(`Food expenditure share of GDP (%), logged` ~ `GDP / capita (USD), logged`, this_df_plot)
  #summary(mod)
  m <- round(mod$coefficients[2], 2)
  b <- round(mod$coefficients[1], 2)
  df_out <- as.data.frame(broom::glance(mod))
  adjR2 <- round(df_out$adj.r.squared, 2)
  facet_labels[i] <- paste0("Adj R squared = ", adjR2, "\nSlope = ", m, ", y-intercept = ", b)
  adjR2_vec[i] <- adjR2
}

names(facet_labels) <- region_vec

gg <- ggplot(df_plot, aes(x = `GDP / capita (USD), logged`,
                          y = `Food expenditure share of GDP (%), logged`,
                          group = Region, fill = Region, shape = Region,
                          label = label_these))
gg <- gg + geom_point(alpha = 0.6, size = point_size, color = "black", stroke = 1)
gg <- gg + scale_fill_manual(values = color_vec)
gg <- gg + scale_shape_manual(values = shape_vec)
gg <- gg + geom_smooth(method = lm, se = F)
gg <- gg + facet_wrap(~Region, ncol = 3, scales = "free", labeller = labeller(Region = facet_labels))
gg <- gg + geom_text_repel(color = "black", size = label_size)
gg <- gg + theme(strip.background = element_blank(),
                 strip.text.x = element_text(hjust = -0.01),
                 #legend.direction = "vertical",
                 #legend.spacing.y = unit(1, 'cm'),
                 legend.title = element_blank())
gg <- gg + guides(fill = guide_legend(#nrow = 2,
  override.aes = list(linetype = 0)),
  color = guide_legend(override.aes = list(linetype = 0)))
gg <- shift_legend2(gg)
gg <- ggplotify::as.ggplot(gg)
#gg
#ggsave("Engels Law 1 Disaggregated.png", width = 8.5, height = 6.5, units = "in")
#==========================================================================
# df_bennett_2017 <- subset(df_bennett[, c("Country", "Year", "Carb share of diet (%), logged")], Year == 2017)
# 
# df <- merge(df_plot, df_bennett_2017, by = "Country")
# 
# df_mod <- df[, c("GDP / capita (USD), logged",
#                  "Food expenditure share of GDP (%), logged",
#                  "Carb share of diet (%), logged" )]

# mod <- lm(`GDP / capita (USD), logged`~., df_mod)
# summary(mod)



# this_file <- "ConsumerPriceIndices_E_All_Data.csv"
# this_folder <- "C:/Users/bensc/OneDrive/Documents/Data/FAO Data/"
# this_filepath <- paste0(this_folder, this_file)
# df_cpi <- read.csv(this_filepath, stringsAsFactors = F)
# 
# rm_cols <- c("Area.Code", "Item.Code", "Months.Code")
# rm_cols <- which(colnames(df_cpi) %in% rm_cols)
# df_cpi <- df_cpi[, -rm_cols]
# #unique(df_cpi$Item)
# df_cpi$Item <- as.character(df_cpi$Item)
# df_cpi$Area <- as.character(df_cpi$Area)
# u <- colnames(df_cpi)
# df_cpi <- df_cpi[, -grep("F", u)]
# u <- colnames(df_cpi)
# df_cpi <- df_cpi[, -grep("N", u)]
# v <- colnames(df_cpi)[5:ncol(df_cpi)]
# colnames(df_cpi)[5:ncol(df_cpi)] <- gsub("Y", "", v)
# #---------------------------------------------------------------------------
# # Check available years
# #colnames(df_cpi)
# #---------------------------------------------------------------------------
# available_yrs <- as.character(c(2000:2020))
# df_cpi <- gather_(df_cpi, "Year", "Value", gather_cols = available_yrs)
# df_cpi$Unit <- NULL
# #---------------------------------------------------------------------------
# year_vec <- as.character(c(2010:2020))
# df_cpi <- subset(df_cpi, Item == "Consumer Prices, Food Indices (2010 = 100)" &
#                        Year %in% year_vec)
# df_cpi <- df_cpi[which(!is.na(df_cpi$Value)), ]
# #---------------------------------------------------------------------------
# # Select year for CPI
# # df_check <- subset(df_cpi, Year == "2018")
# # df_check <- df_check %>% group_by(Area) %>%
# #   mutate(n_months = length(Value)) %>% as.data.frame()
# # unique(df_check$n_months)
# # length(unique(df_check$Area[which(df_check$n_months > 8)]))
# this_year <- "2017"
# #---------------------------------------------------------------------------
# df_cpi <- subset(df_cpi, Year == this_year)
# df_cpi <- df_cpi %>% group_by(Area) %>%
#   mutate(n_months = length(Value)) %>% as.data.frame()
# #unique(df_cpi$n_months)
# df_cpi <- subset(df_cpi, n_months > 8)
# df_cpi$Year <- NULL
# df_cpi$n_months <- NULL
# df_cpi <- df_cpi %>% group_by(Area) %>% 
#   mutate(CV = sd(Value, na.rm = T) / mean(Value, na.rm = T)) %>%
#   as.data.frame()
# df_cpi <- df_cpi[-which(duplicated(df_cpi$CV)), ]
# df_cpi <- df_cpi[, c("Area", "CV")]
# # length(unique(df_cpi$Area))
# # unique(df_cpi$Item)
# colnames(df_cpi) <- c("Country", paste("Food CPI Volatility (CV)", this_year))
# 
# df <- merge(df_plot[, c("Country", "Region")], df_cpi, by = "Country")
# 
# df <- df %>% group_by(Region) %>%
#   summarise(`Food CPI Volatility (CV) 2017` = mean(`Food CPI Volatility (CV) 2017`)) %>% as.data.frame()
# 
# df <- merge(df, data.frame(Region = region_vec, fit = adjR2_vec), by = "Region")
# 
# gg <- ggplot(df, aes(x = fit, y = `Food CPI Volatility (CV) 2017`))
# gg <- gg + geom_point()
# gg <- gg + scale_x_log10() + scale_y_log10()
# gg
#==========================================================================
# Quartile
# gdp <- df_plot$`GDP / capita (USD), logged`
# q <- quantile(gdp)
# 
# df_plot$Quartile <- NA
# df_plot$Quartile[which(gdp < q[2])] <- "1st Quartile"
# df_plot$Quartile[which(gdp >= q[2] & gdp < q[3])] <- "2nd Quartile"
# df_plot$Quartile[which(gdp >= q[3] & gdp < q[4])] <- "3rd Quartile"
# df_plot$Quartile[which(gdp >= q[4])] <- "4th Quartile"
# 
# 
# quartile_vec <- unique(df_plot$Quartile)
# facet_labels <- c()
# for(i in 1:length(quartile_vec)){
#   this_quartile <- quartile_vec[i]
#   this_df_plot <- subset(df_plot, Quartile == this_quartile)
#   mod <- lm(`Food expenditure share of GDP, logged` ~ `GDP / capita (USD), logged`, this_df_plot)
#   #summary(mod)
#   m <- round(mod$coefficients[2], 2)
#   b <- round(mod$coefficients[1], 2)
#   df_out <- as.data.frame(broom::glance(mod))
#   adjR2 <- round(df_out$adj.r.squared, 2)
#   facet_labels[i] <- paste0("Adj R squared = ", adjR2, "\nSlope = ", m, ", y-intercept = ", b)
# }
# 
# names(facet_labels) <- quartile_vec
# 
# gg <- ggplot(df_plot, aes(x = `GDP / capita (USD), logged`,
#                           y = `Food expenditure share of GDP, logged`,
#                           group = Quartile, fill = Quartile, shape = Quartile,
#                           label = label_these))
# gg <- gg + geom_point(alpha = 0.6, size = point_size, color = "black", stroke = 1)
# gg <- gg + scale_fill_manual(values = color_vec)
# gg <- gg + scale_shape_manual(values = shape_vec)
# gg <- gg + geom_smooth(method = lm, se = F)
# gg <- gg + facet_wrap(~Quartile, ncol = 2, scales = "free", labeller = labeller(Quartile = facet_labels))
# gg <- gg + geom_text_repel(color = "black", size = label_size)
# gg <- gg + theme(strip.background = element_blank(),
#                  strip.text.x = element_text(hjust = -0.01),
#                  #legend.direction = "vertical",
#                  #legend.spacing.y = unit(1, 'cm'),
#                  legend.title = element_blank(),
#                  legend.position = "bottom")
# gg <- gg + guides(fill = guide_legend(#nrow = 2,
#   override.aes = list(linetype = 0)),
#   color = guide_legend(override.aes = list(linetype = 0)))
# # gg <- shift_legend2(gg)
# # gg <- ggplotify::as.ggplot(gg)
# gg


```

Alternative formulations of Engel's Law have proliferated since its conception. Some of these have been discredited as poor reflections or distortions of Engel's original formulation [@zimmerman1932ernst]. One alternative formulation that has gained acceptance states that "as income increases, households' demand for food increases less than proportionally" [@cirera2010income]. In this formulation, food expenditure share is simply replaced by food expenditure. Another name for food expenditure is food demand, expressed in units of monetary value. Tilman et al. [-@tilman2011global] take this formulation one step further, expressing food demand in units of calories. Tilman et al. present their formulation as a new discovery. However, the only distinction between this "new discovery" and Engel's Law is the units in which food demand is expressed.

This alternative formulation of Engel's Law facilitates analysis of future food demand. Tilman et al. [-@tilman2011global], for example, estimate a 100% to 110% increase in food demand by 2050 over 2010 levels. Cirera and Masset [-@cirera2010income], meanwhile, use the alternative formulation to reveal an inverse relation between food demand and income inequality, estimating that future food demand could be 2.7% higher than expected if inequality is reduced, or, conversely, 5.4% lower than expected if inequality increases.

Another practical benefit of the calorie demand formulation of Engel's Law is that the FAO food calorie demand data extend back from the present to the 1960s, whereas the World Bank ICP food expenditure share data extend back only to 2011 (and only to 2017 for Africa). The calorie demand formulation thus allows us to examine the stability of the law over a much longer period of time.

```{r Engel2, fig.show = "hold", fig.width = 5, fig.height=4, fig.align="center", fig.cap="\\italic{(Left)} The calorie demand formulation of Engel's Law (2017 data) and \\italic{(Right)} parameter stability over time. Source: Author's creation using FAO Food Balance Sheet data.", echo = FALSE}
rm(df_plot)
this_file <- "Engels Law 3.csv"
df_engel <- read.csv(this_file, stringsAsFactors = F)
df_engel$X <- NULL
colnames(df_engel)[3] <- "Food demand (kcal/capita/day), logged"
colnames(df_engel)[5] <- "GDP / capita (USD), logged"
#--------------------------------------------------------------------------
# Tilman et al. variation of Engel's Law
df_plot <- subset(df_engel, Year == 2017)
df_mod <- df_plot[, setdiff(colnames(df_plot), c("Country", "Year", "Region"))]
#keep_rows <- which(!is.na(df_mod$`Consumption Inequality (Gini Coefficient)`))
#df_mod <- df_mod[keep_rows, ]
keep_rows <- which(!is.na(df_mod$`Food demand (kcal/capita/day), logged`))
df_mod <- df_mod[keep_rows, ]

row.names(df_mod) <- df_plot$Country[keep_rows]
#df_mod$`Income Inequality (Gini Coefficient)` <- NULL
#df_mod$`Consumption Inequality (Gini Coefficient)` <- NULL
#df_mod$`Income Inequality (Gini Coefficient)` <- log(df_mod$`Income Inequality (Gini Coefficient)`)
#df_mod$`Consumption Inequality (Gini Coefficient)` <- log(df_mod$`Consumption Inequality (Gini Coefficient)`)
#df_mod$`Consumption Inequality (Gini Coefficient)` <- NULL
mod <- lm(`Food demand (kcal/capita/day), logged` ~ ., df_mod)
#summary(mod)
#m_gini <- round(mod$coefficients[3], 2)
m_gdp <- round(mod$coefficients[2], 2)
b <- round(mod$coefficients[1], 2)
df_out <- as.data.frame(broom::glance(mod))
adjR2 <- round(df_out$adj.r.squared, 2)

# plot(mod$fitted.values, mod$residuals)
# plot(mod$fitted.values, df_mod$`Food supply (kcal/capita/day), logged`)

# y_lab <- paste(b, "+", m_gdp, "(GDP/capita (USD, 2015 prices), logged) +\n",
#       m_gini, "(Consumption Inequality (Gini Coefficient), logged)")

# df_mod$`6.93 + 0.1 (GDP/capita (USD, 2015 prices), logged) +\n -0.14 (Consumption Inequality (Gini Coefficient), logged)` <-
#   mod$fitted.values
# df_mod$Area <- row.names(df_mod)
# df_mod <- merge(df_mod, df_plot[, c("Area", "Region")], by = "Area")
# df_plot <- df_mod
#unique(df_plot$Area[grep("Korea", df_plot$Area, ignore.case = T)])
df_plot$label_these <- NA
u <- which(df_plot$Country %in% labelThese_vec)
df_plot$label_these[u] <- df_plot$Country[u]
df_engel2 <- df_plot
# n <- length(unique(df_plot$Region))
# bag_of_colors <- randomcoloR::distinctColorPalette(k = 2 * n)
# color_vec <- sample(bag_of_colors, n)
this_subtitle <- paste0("Adj. R-squared = ", adjR2, "\nSlope = ", m_gdp, ", y-intercept = ", b)
gg <- ggplot(df_plot, aes(x = `GDP / capita (USD), logged`,
                          y = `Food demand (kcal/capita/day), logged`,
                          group = Region, fill = Region, shape = Region,
                          label = label_these))
# gg <- gg + geom_point(aes(fill = Region, group = Region, shape = Region), pch = 21, alpha = 0.5, size = 6, color = "black")
gg <- gg + geom_point(alpha = 0.6, size = point_size, color = "black", stroke = 1)
gg <- gg + scale_fill_manual(values = color_vec)
gg <- gg + scale_shape_manual(values = shape_vec)
# gg <- gg + geom_abline(slope = m, intercept = b,
#                        linetype = "dashed", size = 1)
gg <- gg + geom_smooth(aes(group = NULL, fill = NULL, shape = NULL), method = lm, se = F)
gg <- gg + geom_text_repel(color = "black", size = label_size)
gg <- gg + labs(title = "The calorie demand formulation of Engel's Law", 
  subtitle = this_subtitle)#,
#caption = "Source: Author's creation based on World Bank International Comparison Program Data for 2017.
#GDP/capita is based on 2015 prices.")
gg <- gg + guides(fill = guide_legend(nrow = 2, byrow = T, override.aes = list(linetype = 0)),
                  color = guide_legend(override.aes = list(linetype = 0)))
gg <- gg + theme(legend.position = "bottom",
                 legend.spacing.x = unit(0.5, 'cm'),
                 legend.title = element_blank())
gg_EngelKcal <- gg
#ggsave("Engels Law 3.png", width = 8.5, height = 6.5, units = "in")
#===========================================================================
# Stability
rm(df_plot)
this_file <- "Engels Law stability.csv"
df_params <- read.csv(this_file, stringsAsFactors = F)
df_params$X <- NULL
colnames(df_params)[2:3] <- c("Food demand (kcal/capita/day), logged",
                              "GDP / capita (USD), logged")
#--------------------------------------------------------------------------
yr_vec <- unique(df_params$Year)
n_yrs <- length(yr_vec)
m_vec <- c()
b_vec <- c()
adjR2_vec <- c()
for(i in 1:n_yrs){
  this_year <- yr_vec[i]
  this_df <- subset(df_params, Year == this_year)
  this_df$Year <- NULL
  mod <- lm(`Food demand (kcal/capita/day), logged`~., this_df)
  m_vec[i] <- round(mod$coefficients[2], 3)
  b_vec[i] <- round(mod$coefficients[1], 3)
  df_out <- as.data.frame(broom::glance(mod))
  adjR2_vec[i] <- df_out$adj.r.squared
  
}

df_plot <- data.frame(Year = yr_vec, Slope = m_vec, b_vec, adjR2_vec)
colnames(df_plot)[3:4] <- c("Y-intercept", "Adj. R squared")
# mean(df_plot$Slope)
# sd(df_plot$Slope)
# mean(df_plot$`Y-intercept`)
# sd(df_plot$`Y-intercept`)

df_plot$Year <- as.integer(as.character(df_plot$Year))
df_plot <- df_plot %>% gather(Type, Value, Slope:`Adj. R squared`)
gg <- ggplot(df_plot, aes(x = Year, y = Value))
gg <- gg + geom_line()
gg <- gg + facet_wrap(~Type, ncol = 1, scales = "free_y")
gg <- gg + labs(subtitle = "Stability over time")
gg <- gg + theme(axis.title = element_blank(),
                 strip.background = element_blank())
gg_Engel0Stab <- gg
#===========================================================================
gg_EngelKcal + gg_Engel0Stab + plot_layout(ncol = 2)

```

An example of the calorie demand formulation of Engel's Law is given in the left panel of Figure \ref{fig:Engel2}. The fit (Adjusted R squared) is reasonable, but not quite as good as the fit observed in the original formulation. Like Bennett's Law, the parameters of Engel's Law exhibit stability over time (right panel). An animation of the left panel of Figure \ref{fig:Engel2} over the years 1970 to 2018, provided in the supplemental materials, offers a striking visualization of this stability.
Again, note that the slope and y-intercept appear to be inversely related...graph...effectively reducing to a one parameter model.
<!-- After rising to a peak value of about 0.11 in 1980, the slope has gradually decreased to about 0.09. The y-intercept, meanwhile, has risen from about 6.9 to about 7.2. -->
```{r}

df_plot <- subset(df_plot, Year >= 1980)
df_plot <- df_plot %>% spread(Type, Value)
df_plot <- df_plot[, c("Y-intercept", "Slope")]
mod <- lm(Slope ~., df_plot)
summary(mod)

gg <- ggplot(df_plot, aes(x = `Y-intercept`, y = Slope))
gg <- gg + geom_point()
gg


```


# Two laws, or two manifestations of the same law?

Both Engel's Law and Bennett's Law express a log-linear relation between a particular budget (total and food budget, respectively) and demand for a particular good (food and carbohydrates, respectively). Is there something unique about these laws and the goods they cover, or can they be generalized to a single law governing the income elasticity of demand for any good?

At first, it may seem that there is something special about food that sets it apart from other goods. In the early discussion surrounding Engel's Law, analogous laws for clothing, rent, and utilities were also proposed [@zimmerman1932ernst], but did not exhibit the same consistency as Engel's Law, and are no longer discussed today.

While it is true that certain metabolic constraints intrinsically limit the amount of food that the human organism can make use of in any given time period, the same can be said of non-food goods such as toilet paper and exercise equipment. Non-metabolic, but perfectly analagous, constraints similarly limit the usefulness of glue, jet fuel, and diamonds. There is thus nothing particularly unique about food in this respect. The Law of Diminishing Marginal Utility applies to everything. Astute observers have documented this law, in one guise or another, throughout much of written history [@kauder1953genesis]. In 1738, Daniel Bernoulli put it this way:

>"[i]n the absence of the unusual, the utility resulting from any small increase in wealth will be inversely proportionate to the quantity of goods previously possessed" [@bernoulli1954exposition].

Bernoulli's statement can be formalized as follows.

\begin{equation}
\frac{\partial U}{\partial x} \sim \frac{1}{x}
\label{eq:dimUtilDefine}
\end{equation}

Where, to be clear, the term $\frac{\partial U}{\partial x}$ is the marginal change in utility given a marginal increase in the quantity of good $x$, and "$\sim 1 / x$", means "inversely proportionate to the quantity of good $x$ already acquired". It then follows that

\begin{equation}
\begin{split}
\int \frac{d U}{d x} \: dx = \int \alpha \frac{d \ln(x)}{dx} \: dx \\
U(x)  &= \alpha \ln(x) + k
\end{split}
\label{eq:integrate_lnU}
\end{equation}

Where the proportionality constant $\alpha = dU/d\ln(x)$ regulates the marginal change in utility given a $1$ percent increase in good $x$.

Assuming that consumers want to maximize utility, then the marginal utility of the good must be equal to the marginal utility of the consumer's budget (income), $B$.

\begin{equation}
\alpha_B \frac{d \ln(B)}{dx} = \int \alpha_x \frac{d \ln(x)}{dx}
\label{eq:assumption}
\end{equation}

If $x$ is defined as an expenditure, and other expenditures are held constant, then $dB = dx$, and

\begin{equation}
\begin{split}
\int \alpha_B \frac{d \ln(B)}{dx} \: dx = \int \alpha_x \frac{d \ln(x)}{dx} \: dx \\
\alpha_B \ln(B) + k_B  &= \alpha_x \ln(x) + k_x
\end{split}
\end{equation}

Which can then be rearranged into a log-linear expression.

\begin{equation}
\ln(x) = \beta \ln(B) + c \:\:; \:\:\: \beta = \alpha_B / \alpha_x = \frac{d \ln(x)}{d \ln(B)} \:\: c = (k_B - k_x) / \alpha_x
\label{eq:general_law}
\end{equation}

Engel's Law and Bennett's Law may thus be considered particular instances of this more general principle governing the income elasticity of demand for any good $x$, derived from the Law of Diminishing Marginal Utility (equation \ref{eq:dimUtilDefine}) and the assumption that consumers are utility maximizers (equation \ref{eq:assumption}).

Note that the slope $\beta$ is the ratio $\alpha_B / \alpha_x$. A value of $\beta$ less than $1$ therefore indicates that the percentage increase in utility resulting from from a $1$ percent increase in $x$ is greater than the percentage increase in utility resulting from a $1$ percent increase in income. This can be interpreted as saying that the consumer's need or apetite for $x$ is more quickly satisfied than their need for income. As a consequence, expenditure on $x$ rises less than proportionately with income. This is the case corresponding to Engel's and Bennett's Laws. A value of $\beta$ greater than $1$ indicates that the consumer's need for $x$ is less quickly satisfied than their need for income.^[If $x$ is expressed as an expenditure share, then replace $1$ with $0$.]

Note, moreover, that an increase in the price of $x$ effectively results in a decrease in satisfaction per unit expenditure on $x$, and vice versa. It follows, then, that $\beta$ is largely determined by the price of $x$ relative to other goods, with high values of $\beta$ corresponding to high prices of good $x$ relative to other goods, and vice versa. This may help to explain the geographical variation in slope observed in Figures ... and ...; as well as the temporal variation observed in Figures ... and ....

This also shines a light on the circumstances under which Engel's and Bennett's Laws could be violated. One can conceive of situations of extreme poverty and/or of soaring prices, for example, such that $\beta$ turns greater than $1$ for a wide range of goods, including food. Likewise, the laws for non-food goods discussed in the early literature may not have "caught on" as well as Engel's and Bennett's Laws due to wide variations in their relative prices from one place and time to another.

# A new empirical law: expected price and price volatility

...Figure \ref{fig:price_series}. It seems that the higher the price, the more volatile it is... The phenomenon can be observed across a wide range of food and non-food agricultural commodities. It can also be seen to occur with both raw and processed versions of the commodities. The relation appears to persist across a wide range of food price epochs, from the oil driven spike of the 1970s through to the more recent 2007-2008 crisis. Plotting the mean price against its standard deviation offers striking confirmation... \ref{fig:risk_reward}

```{r priceSeries, fig.show = "hold", fig.width = 6, fig.height=4, fig.align="center", fig.cap="The higher the price, the more volatile. FAO data 1972-2017.", echo = FALSE}
this_file <- "FAO export data world.csv"
df_export_world <- read.csv(this_file, stringsAsFactors = F)
df_export_world$X <- NULL
colnames(df_export_world)[4:6] <- c("Export Quantity", "Export Value",
                                    "World Export Price (USD / metric ton)")
#=============================================================================
plot_these <- c("Maize", "Apples", "Cocoa, beans", "Cocoa, butter")
df_plot <- subset(df_export_world, Item %in% plot_these &
                    Year >= 1972)
yr_1 <- unique(df_plot$Year)[1]
yr_n <- max(unique(df_plot$Year))
gg <- ggplot(df_plot, aes(x = Year, y = `World Export Price (USD / metric ton)`, group = Item, color = Item)) + geom_line(lwd = 1)
gg <- gg + scale_x_continuous(breaks = seq(yr_1, yr_n, length.out = 6))
#gg <- gg + scale_y_log10()
gg <- gg + theme(axis.title.x = element_blank(),
                 legend.title = element_blank(),
                 legend.position = "top")
gg

```

...Figure \@ref(fig:riskReward)

```{r riskReward, fig.show = "hold", fig.width = 6, fig.height=6, fig.align="center", fig.cap="Logged expected price plotted against logged standard deviation. 'Export price' here equals FAO's Export Value series divided by its Export Quantity series, downloaded from FAOSTAT.", echo = FALSE}

df_riskReward <- df_export_world %>% group_by(Item) %>%
  summarise(`Mean World Export Price (USD / metric ton)` = mean(`World Export Price (USD / metric ton)`, na.rm = T),
            `Stand. Dev. World Export Price (USD / metric ton)` = sd(`World Export Price (USD / metric ton)`, na.rm = T),
            `Mean Export Qty.` = mean(`Export Quantity`, na.rm = T), 
            `Mean Export Value ('000 USD)` = mean(`Export Value`, na.rm = T))

df_riskReward$`Mean World Export Price (USD / metric ton), logged` <-
  log(df_riskReward$`Mean World Export Price (USD / metric ton)`)
df_riskReward$`Stand. Dev. World Export Price (USD / metric ton), logged` <-
  log(df_riskReward$`Stand. Dev. World Export Price (USD / metric ton)`)
#--
df_riskReward <- df_riskReward[which(!is.na(df_riskReward$`Stand. Dev. World Export Price (USD / metric ton), logged`)), ]
#nrow(df_riskReward)
#----------------------------------------------------------------------------
df_mod <- df_riskReward[, c("Mean World Export Price (USD / metric ton), logged", "Stand. Dev. World Export Price (USD / metric ton), logged")]
#nrow(df_mod)
row.names(df_mod) <- df_riskReward$Item
mod <- lm(`Mean World Export Price (USD / metric ton), logged` ~., df_mod)
#summary(mod)
b <- round(mod$coefficients[1], 2)
m <- round(mod$coefficients[2], 2)
#---
# gg <- ggplot(data.frame(Item = row.names(df_mod), yhat = mod$fitted.values,
#                         resid = mod$residuals),
#              aes(x = yhat, y = resid, label = Item))
# gg <- gg + geom_point() + geom_text()
# gg <- gg + geom_hline(yintercept = c(-1, 1), color = "red")
# gg
#---
ind_outlier <- which(abs(as.numeric(mod$residuals)) >= 0.75)
excluded_items <- row.names(df_mod)[ind_outlier]
pct_removed <- 100 * length(ind_outlier) / nrow(df_riskReward)
row_names <- row.names(df_mod)[-ind_outlier]
df_mod <- df_mod[-ind_outlier, ]
row.names(df_mod) <- row_names
mod <- lm(`Mean World Export Price (USD / metric ton), logged` ~., df_mod)
#summary(mod)
b <- round(mod$coefficients[1], 2)
m <- round(mod$coefficients[2], 2)
#plot(mod$fitted.values, mod$residuals)
#----------------------------------------------------------------------------
#df_riskReward$Item[ind_outlier]
df_plot <- df_riskReward[-ind_outlier, c("Item", "Mean World Export Price (USD / metric ton), logged", "Stand. Dev. World Export Price (USD / metric ton), logged",
                             "Mean Export Value ('000 USD)")]

df_plot$`Mean Export Value\n(million USD)` <- df_plot$`Mean Export Value ('000 USD)` / 1000

labelItems <- c("Maize", "Cassava dried", "Flour, wheat", "Starch, cassava",
              "Coffee, green", "Coffee, roasted", "Wheat", "Bananas",
              "Plantains", "Potatoes", "Cassava Equivalent", "Cocoa, beans",
              "Wool, greasy", "Beans, dry", "Cotton lint", "Silk", "Apples",
              "Soybeans", "Oil, soybean", "Rubber, natural", "Rice",
              "Cocoa, butter")

df_plot$label_these <- NA
u <- df_plot$Item
df_plot$label_these[which(u %in% labelItems)] <- u[which(u %in% labelItems)]

label_size <- 4
gg <- ggplot(df_plot, aes(x = `Stand. Dev. World Export Price (USD / metric ton), logged`,
                          y = `Mean World Export Price (USD / metric ton), logged`))
gg <- gg + geom_smooth(method = lm, se = F)
gg <- gg + geom_point(aes(size = `Mean Export Value\n(million USD)`),
                      fill = "khaki1", pch=21, color="Black")
gg <- gg + geom_text_repel(aes(label = label_these), size = label_size)
gg <- gg + labs(title = "The risk-return frontier", subtitle = paste0("Slope = ", m, "  Y intercept = ", b))
gg <- gg + theme(legend.position = "bottom")
gg <- gg + labs(title = "The ag commodity risk-return frontier",
                caption = "Source: Author's creation using FAOSTAT export value and quantity series 1961-2017.")
gg
#ggsave("risk reward frontier.pdf")
```

...Figure \ref{fig:riskRewardByRegion}

```{r riskRewardByRegion, fig.show = "hold", fig.width = 7, fig.height=6, fig.align="center", fig.cap="Logged expected price plotted against logged standard deviation, by region.", echo = FALSE}
this_file <- "FAO export data regions.csv"
df_export_regions <- read.csv(this_file, stringsAsFactors = F)
df_export_regions$X <- NULL
colnames(df_export_regions)[4:6] <- c("Export Quantity", "Export Value",
                                    "Region Export Price (USD / metric ton)")
#============================================================================
#colnames(df_export_regions)
df_riskReward_regions <- df_export_regions %>% group_by(Region, Item) %>%
  summarise(`Mean Region Export Price (USD / metric ton)` = mean(`Region Export Price (USD / metric ton)`, na.rm = T),
            `Stand. Dev. Region Export Price (USD / metric ton)` = sd(`Region Export Price (USD / metric ton)`, na.rm = T),
            `Mean Export Qty.` = mean(`Export Quantity`, na.rm = T), 
            `Mean Export Value ('000 USD)` = mean(`Export Value`, na.rm = T))

df_riskReward_regions$`Mean Region Export Price (USD / metric ton), logged` <-
  log(df_riskReward_regions$`Mean Region Export Price (USD / metric ton)`)
df_riskReward_regions$`Stand. Dev. Region Export Price (USD / metric ton), logged` <-
  log(df_riskReward_regions$`Stand. Dev. Region Export Price (USD / metric ton)`)
df_riskReward_regions$`Mean Export Value\n(million USD)` <-
  df_riskReward_regions$`Mean Export Value ('000 USD)` / 1000
#--
df_riskReward_regions <- df_riskReward_regions[which(!is.na(df_riskReward_regions$`Stand. Dev. Region Export Price (USD / metric ton), logged`)), ]
ind_rm <- which(is.infinite(df_riskReward_regions$`Stand. Dev. Region Export Price (USD / metric ton), logged`))
#df_riskReward_regions$Item[ind_rm] #look
df_riskReward_regions <- df_riskReward_regions[-ind_rm, ]
#nrow(df_riskReward_regions)
#----------------------------------------------------------------------------
df_plot <- df_riskReward_regions
gg <- ggplot(df_plot, aes(x = `Stand. Dev. Region Export Price (USD / metric ton), logged`,
                          y = `Mean Region Export Price (USD / metric ton), logged`))
#gg <- gg + geom_smooth(method = lm, se = F)
gg <- gg + geom_point(aes(size = `Mean Export Value\n(million USD)`),
                      fill = "khaki1", pch=21, color="Black")
#gg <- gg + geom_text_repel(aes(label = label_these), size = label_size)
gg <- gg + facet_wrap(~Region)
gg <- gg + labs(title = "The ag commodity risk-return frontier, by region",
                caption = "Source: Author's creation using FAOSTAT export value and quantity series 1961-2017.")
gg <- shift_legend2(gg)
gg <- ggplotify::as.ggplot(gg)
```

